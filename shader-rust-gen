#!/usr/bin/env python3

import os

dir_path = "out/shaders"

shaders = set()

# Iterate directory
for relative_file_path in os.listdir(dir_path):
    file_path = os.path.join(dir_path, relative_file_path)
    if file_path.endswith(".vert.spv"):
        shader_name = relative_file_path[:-len(".vert.spv")]
        shaders.add(shader_name)

print("# Generated by shader-rust-gen")
print("")
print("struct Shaders {")
for shader in shaders:
    print(f"    {shader}: Shader,")
print("}")
print("")

print("impl Shaders {")
print("    fn load(device: VkDevice) -> Self {")
print("        Self {")
for shader in shaders:
    print(f'            {shader}: compile(include_bytes!("../{dir_path}/{shader}.vert.spv"))')
print("        }")
print("    }")
print("}")
